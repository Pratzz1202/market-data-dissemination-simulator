version: "3.8"

services:
  server:
    build:
      context: ..
      dockerfile: docker/Dockerfile.server
    command: ["/app/build/mdd_server", "--config", "/app/instruments.json", "--address", "0.0.0.0:50051"]
    ports:
      - "50051:50051"

  client:
    build:
      context: ..
      dockerfile: docker/Dockerfile.client
    depends_on:
      - server
    command: ["/app/build/mdd_client", "--host", "server:50051", "--subscribe", "BTC-USD", "--subscribe", "ETH-USD", "--depth", "10"]
